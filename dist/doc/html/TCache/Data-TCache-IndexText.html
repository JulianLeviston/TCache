<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Data.TCache.IndexText</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Data-TCache-IndexText.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">TCache-0.11.0.0: A Transactional cache with user-defined persistence</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Data.TCache.IndexText</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implements full text indexation (<code><a href="Data-TCache-IndexText.html#v:indexText">indexText</a></code>) and text search(<code><a href="Data-TCache-IndexText.html#v:contains">contains</a></code>), as an addition to
the query language implemented in <code><a href="Data-TCache.html#t:IndexQuery">IndexQuery</a></code>
it also can index the lists of elements in a field (with <code><a href="Data-TCache-IndexText.html#v:indexList">indexList</a></code>)
so that it is possible to ask for the registers that contains a given element
in the given field (with <code><a href="Data-TCache-IndexText.html#v:containsElem">containsElem</a></code>)
</p><p>An example of full text search and element search in a list in combination
using the <code><a href="Data-TCache-IndexQuery.html#v:.-38--38-.">.&amp;&amp;.</a></code> operator defined in <a href="indexQuery.html">indexQuery</a>.
before and after the update of the register
</p><pre>
data Doc= Doc{title :: String , authors :: [String], body :: String} deriving (Read,Show, Typeable)
instance Indexable Doc where
  key Doc{title=t}= t

instance Serializable Doc  where
  serialize= pack . show
  deserialize= read . unpack

main= do
  <code><a href="Data-TCache-IndexText.html#v:indexText">indexText</a></code>  body T.pack
  <code><a href="Data-TCache-IndexText.html#v:indexList">indexList</a></code> authors  (map T.pack)

let doc= Doc{title=  &quot;title&quot;, authors=[&quot;john&quot;,&quot;Lewis&quot;], body=  &quot;Hi, how are you&quot;}
  rdoc &lt;- atomically $ newDBRef doc

r0 &lt;- atomically $ <code><a href="Data-TCache-IndexQuery.html#v:select">select</a></code> title $ authors `<code><a href="Data-TCache-IndexText.html#v:containsElem">containsElem</a></code>` &quot;Lewis&quot;
  print r0

r1 &lt;- atomically $ <code><a href="Data-TCache-IndexQuery.html#v:select">select</a></code> title $ body `<code><a href="Data-TCache-IndexText.html#v:contains">contains</a></code>` &quot;how are you&quot;
  print r1

r2 &lt;- atomically $ <code><a href="Data-TCache-IndexQuery.html#v:select">select</a></code> body $ body `<code><a href="Data-TCache-IndexText.html#v:contains">contains</a></code>` &quot;how are you&quot; .&amp;&amp;. authors <code><a href="Data-TCache-IndexText.html#v:containsElem">containsElem</a></code> <a href="john.html">john</a>
  print r2

atomically $ writeDBRef rdoc  doc{ body=  &quot;what's up&quot;}

r3 &lt;- atomically $ <code><a href="Data-TCache-IndexQuery.html#v:select">select</a></code> title $ body  `'contains'\` &quot;how are you&quot;
  print r3

if  r0== r1 &amp;&amp; r1== [title doc] then print &quot;OK&quot; else print &quot;FAIL&quot;
  if  r3== [] then print &quot;OK&quot; else print &quot;FAIL&quot;
</pre></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:indexText">indexText</a> :: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b) =&gt; (a -&gt; b) -&gt; (b -&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib\extralibs\doc\text-0.11.3.1\html/Data-Text-Lazy-Internal.html#t:Text">Text</a>) -&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:indexList">indexList</a> :: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b) =&gt; (a -&gt; b) -&gt; (b -&gt; [<a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib\extralibs\doc\text-0.11.3.1\html/Data-Text-Lazy-Internal.html#t:Text">Text</a>]) -&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:contains">contains</a> :: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b) =&gt; (a -&gt; b) -&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a> -&gt; <a href="Data-TCache.html#t:STM">STM</a> [<a href="Data-TCache-Defs.html#t:DBRef">DBRef</a> a]</li><li class="src short"><a href="#v:containsElem">containsElem</a> :: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b) =&gt; (a -&gt; b) -&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a> -&gt; <a href="Data-TCache.html#t:STM">STM</a> [<a href="Data-TCache-Defs.html#t:DBRef">DBRef</a> a]</li><li class="src short"><a href="#v:allElemsOf">allElemsOf</a> :: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b) =&gt; (a -&gt; b) -&gt; <a href="Data-TCache.html#t:STM">STM</a> [<a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib\extralibs\doc\text-0.11.3.1\html/Data-Text-Lazy-Internal.html#t:Text">Text</a>]</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a name="v:indexText" class="def">indexText</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; b)</td><td class="doc"><p>field to index
</p></td></tr><tr><td class="src">-&gt; (b -&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib\extralibs\doc\text-0.11.3.1\html/Data-Text-Lazy-Internal.html#t:Text">Text</a>)</td><td class="doc"><p>method to convert the field content to lazy Text (for example <code><a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/bytestring-0.10.0.2/Data-ByteString-Lazy-Char8.html#v:pack">pack</a></code> in case of String fields). This permits to index non Textual fields
</p></td></tr><tr><td class="src">-&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>start a trigger to index the contents of a register field
</p></div></div><div class="top"><p class="src"><a name="v:indexList" class="def">indexList</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; b)</td><td class="doc"><p>field to index
</p></td></tr><tr><td class="src">-&gt; (b -&gt; [<a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib\extralibs\doc\text-0.11.3.1\html/Data-Text-Lazy-Internal.html#t:Text">Text</a>])</td><td class="doc"><p>method to convert a field element to Text (for example `pack . show` in case of elemets with Show instances)
</p></td></tr><tr><td class="src">-&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>trigger the indexation of list fields with elements convertible to Text
</p></div></div><div class="top"><p class="src"><a name="v:contains" class="def">contains</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; b)</td><td class="doc"><p>field to search in
</p></td></tr><tr><td class="src">-&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a></td><td class="doc"><p>text to search
</p></td></tr><tr><td class="src">-&gt; <a href="Data-TCache.html#t:STM">STM</a> [<a href="Data-TCache-Defs.html#t:DBRef">DBRef</a> a]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>return the DBRefs whose fields include all the words in the requested text contents.Except the
 words  with less than three characters that are not digits or uppercase, that are filtered out before making the query
</p></div></div><div class="top"><p class="src"><a name="v:containsElem" class="def">containsElem</a> :: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b) =&gt; (a -&gt; b) -&gt; <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a> -&gt; <a href="Data-TCache.html#t:STM">STM</a> [<a href="Data-TCache-Defs.html#t:DBRef">DBRef</a> a]</p><div class="doc"><p>return the DBRefs of the registers whose field (first parameter, usually a container) contains the requested value.
</p></div></div><div class="top"><p class="src"><a name="v:allElemsOf" class="def">allElemsOf</a> :: (<a href="Data-TCache-IResource.html#t:IResource">IResource</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a, <a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib/../doc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> b) =&gt; (a -&gt; b) -&gt; <a href="Data-TCache.html#t:STM">STM</a> [<a href="C:\Program Files (x86)\Haskell Platform\2013.2.0.0\lib\extralibs\doc\text-0.11.3.1\html/Data-Text-Lazy-Internal.html#t:Text">Text</a>]</p><div class="doc"><p>return all the values of a given field (if it has been indexed with <code><a href="Data-TCache-IndexQuery.html#v:index">index</a></code>)
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>